# 递推数列

## 一阶线性递推数列
一阶线性递推数列：$a_{n+1}=pa_n+q$  
### 特定系数法
1. $p=1$，那这就是一个公差为$q$的等差数列：$a_n=a_1+(n-1)q$
2. $p\not ={1}$，可以使用`特定系数法`构造等比数列：  

    设存在c使得$a_{n+1}-c=p(a_n-c)$，整理的：$c=\frac{q}{1-p}$  
    进而求得：$a_{n+1}-\frac{q}{1-p}=p(a_n-\frac{q}{1-p})$  

    此时，$a_n-\frac{q}{1-p}$是公比为$p$的等比数列，$a_n=p^{n-1}(a_1-\frac{q}{1-p})+\frac{q}{1-p}$。  

    同理，当初始值为$a_0$并知道值时，$a_n=p^{n}(a_0-\frac{q}{1-p})+\frac{q}{1-p}$

### 不动点法
1. **找不动点**，把递推公式中的$a_{n+1}、a_n$都换成$x$，在求解这个方程得到的点就是不动点。
2. **换元**，构造$b_n=\frac{1}{a_n-x_0}$或者$b_n=\frac{a_n-x_1}{a_n-x_2}$，带入原递推公式，化简得到$\{b_n\}$的递推关系，从而求出其通项公式。
3. **求解**，利用$a_n$和$b_n$之间的关系，求出$\{a_n\}$的通项公式。

求解不动点时无解或者代换之后的数列没有变成一个相对简单的关系，这个问题可能并不适合用不动点法解决。

## 二阶线性递推数列
$a_{n+1}=pa_{n}+qa_{n-1}$，已知$a_1、a_2$的值
### 特定系数法
设存在b，c使得$a_{n+1}-ba_n=c(a_n-ba_{n-1})$成立，整理可得：    
$a_{n+1}=(b+c)a_n-b\times{c}\times{a_{n-1}}$。  
$$\left\{ \begin{array}{rcl}
b+c=p & & \\
bc=-q & & \\
\end{array} \right.$$
显然b，c是方程$x^2-px-q=0$的根。  
$x=\frac{p\pm\sqrt{p^2+4q}}{2}$  

因此，上述公式是一个等比数列：$a_{n+1}-ba_n=c^{n-1}(a_2-ba_1)$  

同理可得：$a_{n+1}-ca_n=b(a_n-ca_{n-1})$，$a_{n+1}-ca_n=b^{n-1}(a2-ca1)$

1. $b\not ={c}$，上述两个等比数列公式相减得：   
    $a_n=\frac{b^{n-1}(a_2-ca_1)}{b-c}+\frac{c^{n-1}(a_2-ba_1)}{c-b}$

2. $b=c$，等比数列变为$a_{n+1}-ba_n=b(a_n-b_{n-1})$->  
    $a_{n+1}-ba_n=b^{n-1}(a_2-ba_1)$，两边同时除以$b^{n+1}$得：  
    $\frac{a_{n+1}}{b^{n+1}}-\frac{a_n}{b^n}=\frac{a_2-ba_1}{b^2}$  
    数列$\frac{a_n}{b^n}$是首项$\frac{a_1}{b}$为，公差为$\frac{a_2-ba_1}{b^2}$的等差数列。 

    $a_n=a_1b^{n-1}+(a_2-ba_1)(n-1)b^{n-2}$

### 特征根法
对于数列$a_{n+1}=pa_{n}+qa_{n-1}$，称$x^2=px+q$是数列对应的特征方程，记方程的解为b，c。
1. $b\not ={c}$，数列的通项公式可设为$a_n=\alpha{b^n}+\beta{c^n}$，然后利用$a_1$、$a_2$求出$\alpha$和$\beta$  
2. $b=c$，数列的通项公式可设为$a_n=(\alpha+\beta{n})b^2$，同理利用数列前两项求出